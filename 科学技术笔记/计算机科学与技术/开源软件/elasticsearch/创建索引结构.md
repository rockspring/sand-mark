# 1 创建索引

```
curl -XPUT 'http://127.0.0.1:9200/solrlog/' -d '{
    "settings" : {
        "index" : {
            "number_of_shards" : 5,
            "number_of_replicas" : 1
        }
    }
}' | python -mjson.tool
```

# 2 创建文档映射关系

```

curl -XPUT 'http://127.0.0.1:9200/solrlog/_mapping/service' -d '
{
  "_field_names" : { "store" : true},
  "_routing" : {
      "required" : true,
      "path" : "serivce_name"
  },
  "_index" : { "enabled" : true },
  "_size" : {"enabled" : true, "store" : true },
  "_timestamp" : {
      "enabled" : true,
      "format" : "YYYY-MM-dd",
      "store" : true
  },
  "_ttl" : { 
      "enabled" : true, "default" : "1m" 
  },
  "properties": {
    "serivce_name": {
      "type": "string",
      "index_name": "serivce_name",
      "store": true,
      "index": "analyzed",
      "doc_values": false,
      "term_vector": "with_positions_offsets",
      "boost": 1.0,
      "null_value": "null",
      "norms": {
        "enabled": true
      },
      "norms": {
        "loading": "eager"
      },
      "index_options": "offsets",
      "analyzer": "standard",
      "index_analyzer": "standard",
      "search_analyzer": "standard",
      "include_in_all": "true",
      "ignore_above": 4294967295,
      "position_offset_gap": 0
    }
  }
}
' | python -mjson.tool


curl -XPUT 'http://127.0.0.1:9200/solrlog/_mapping/solrlog' -d '
{
  "_id" : {
      "index" : "not_analyzed",
      "store" : true
  },
  "_type" : {"store" : true},
  "_source" : {"enabled" : true},
  "_all" : {"enabled" : true, "store": true},
  "_analyzer" : {
      "path" : "message_analyzer"
  },
  "_parent" : {
      "type" : "service"
  },
  "_field_names" : { "store" : true},
  "_routing" : {
      "required" : true,
      "path" : "message"
  },
  "_index" : { "enabled" : true },
  "_size" : {"enabled" : true, "store" : true },
  "_timestamp" : {
      "enabled" : true,
      "format" : "YYYY-MM-dd",
      "store" : true
  },
  "_ttl" : { 
      "enabled" : true, "default" : "1m" 
  },
  "properties": {
    "message": {
      "type": "string",
      "fields" : {
          "word_count": {
              "type" : "token_count",
              "store" : "yes",
              "analyzer" : "standard"
          }
      },
      "index_name": "message",
      "store": true,
      "index": "analyzed",
      "doc_values": false,
      "term_vector": "with_positions_offsets",
      "boost": 1.0,
      "null_value": "null",
      "norms": {
        "enabled": true
      },
      "norms": {
        "loading": "eager"
      },
      "index_options": "offsets",
      "analyzer": "standard",
      "index_analyzer": "standard",
      "search_analyzer": "standard",
      "include_in_all": "true",
      "ignore_above": 4294967295,
      "position_offset_gap": 0
    },
    "message_analyzer" : {
      "type": "string",
      "index_name": "message_analyzer",
      "store": true
    },
    "urlLength": {
      "type": "integer",
      "fields" : {
          "word_count": {
              "type" : "token_count",
              "store" : "yes",
              "analyzer" : "standard"
          }
      },
      "index_name": "urlLength",
      "store": true,
      "index": "analyzed",
      "doc_values": false,
      "precision_step": 8,
      "boost": 1.0,
      "null_value": "0",
      "include_in_all": "true",
      "ignore_malformed": false,
      "coerce": true
    },
    "dateTime" : {
      "type": "date",
      "format" : "YYYY-MM-dd",
      "fields" : {
          "word_count": {
              "type" : "token_count",
              "store" : "yes",
              "analyzer" : "standard"
          }
      },
      "index_name": "dateTime",
      "store": true,
      "index": "analyzed",
      "doc_values": false,
      "precision_step": 16,
      "boost": 1.0,
      "null_value": "null",
      "include_in_all": "true",
      "ignore_malformed" : "false" 
    },
    "httpCode200" : {
      "type": "boolean",
      "index_name": "httpCodeOK",
      "store": true,
      "index": "non_analyzed",
      "boost": 1.0,
      "null_value": "false"
    }
  }
}
' | python -mjson.tool

curl -XPUT 'http://127.0.0.1:9200/solrlog/_mapping/solrlog' -d @solrlog_mapping.json  | python -mjson.tool



Doc values need to be setup in the field mapping at index time, and work on numeric, geo and not_analyzed string values, both single and multi-valued
```

# 3 删除索引

```
curl -XDELETE 'http://127.0.0.1:9200/solrlog/' | python -mjson.tool
```

# 4 删除文档映射关系

```
curl -XDELETE 'http://127.0.0.1:9200/solrlog/_mapping/solrlog' | python -mjson.tool
```

# 5 往索引中添加文档，使用已定义的映射关系索引文档

```
curl -XPOST 'http://127.0.0.1:9200/solrlog/solrlog' -d '
{
  "message" : ["周乐钦", "zhouleqin"],
  "message_analyzer" : "whitespace",
  "urlLength" : 100,
  "dateTime" : "2015-02-07",
  "httpCode200" : true
}
' | python -mjson.tool

curl -XPOST 'http://127.0.0.1:9200/solrlog/solrlog' -d @solrlog_data.json  | python -mjson.tool
```

# 6 简单查询

curl -XGET 'http://127.0.0.1:9200/_search?fields=*' | python -mjson.tool
