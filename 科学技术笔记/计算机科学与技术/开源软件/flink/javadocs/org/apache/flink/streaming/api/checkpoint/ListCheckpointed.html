<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="zh">
<head>
<!-- Generated by javadoc (1.8.0_144) on Thu May 17 13:42:25 CST 2018 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>ListCheckpointed</title>
<meta name="date" content="2018-05-17">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="ListCheckpointed";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6,"i1":6};
var tabs = {65535:["t0","所有方法"],2:["t2","实例方法"],4:["t3","抽象方法"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>您的浏览器已禁用 JavaScript。</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="跳过导航链接">跳过导航链接</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="导航">
<li><a href="../../../../../../overview-summary.html">概览</a></li>
<li><a href="package-summary.html">程序包</a></li>
<li class="navBarCell1Rev">类</li>
<li><a href="package-tree.html">树</a></li>
<li><a href="../../../../../../deprecated-list.html">已过时</a></li>
<li><a href="../../../../../../index-files/index-1.html">索引</a></li>
<li><a href="../../../../../../help-doc.html">帮助</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/flink/streaming/api/checkpoint/ExternallyInducedSource.CheckpointTrigger.html" title="org.apache.flink.streaming.api.checkpoint中的接口"><span class="typeNameLink">上一个类</span></a></li>
<li><a href="../../../../../../org/apache/flink/streaming/api/checkpoint/WithMasterCheckpointHook.html" title="org.apache.flink.streaming.api.checkpoint中的接口"><span class="typeNameLink">下一个类</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/flink/streaming/api/checkpoint/ListCheckpointed.html" target="_top">框架</a></li>
<li><a href="ListCheckpointed.html" target="_top">无框架</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">所有类</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>概要:&nbsp;</li>
<li>嵌套&nbsp;|&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method.summary">方法</a></li>
</ul>
<ul class="subNavList">
<li>详细资料:&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method.detail">方法</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.flink.streaming.api.checkpoint</div>
<h2 title="接口 ListCheckpointed" class="title">接口 ListCheckpointed&lt;T extends java.io.Serializable&gt;</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt><span class="paramLabel">类型参数:</span></dt>
<dd><code>T</code> - The type of the operator state.</dd>
</dl>
<dl>
<dt>所有已知实现类:</dt>
<dd><a href="../../../../../../org/apache/flink/streaming/examples/async/AsyncIOExample.SimpleSource.html" title="org.apache.flink.streaming.examples.async中的类">AsyncIOExample.SimpleSource</a></dd>
</dl>
<hr>
<br>
<pre><a href="../../../../../../org/apache/flink/annotation/PublicEvolving.html" title="org.apache.flink.annotation中的注释">@PublicEvolving</a>
public interface <span class="typeNameLabel">ListCheckpointed&lt;T extends java.io.Serializable&gt;</span></pre>
<div class="block">This interface can be implemented by functions that want to store state in checkpoints.
 It can be used in a similar way as the deprecated <code>Checkpointed</code> interface, but
 supports <b>list-style state redistribution</b> for cases when the parallelism of the
 transformation is changed.

 <p>Implementing this interface is a shortcut for obtaining the default <code>ListState</code>
 from the <a href="../../../../../../org/apache/flink/api/common/state/OperatorStateStore.html" title="org.apache.flink.api.common.state中的接口"><code>OperatorStateStore</code></a>. Using the <code>OperatorStateStore</code> directly gives
 more flexible options to use operator state, for example controlling the serialization
 of the state objects, or have multiple named states.

 <h2>State Redistribution</h2>
 State redistribution happens when the parallelism of the operator is changed.
 State redistribution of <i>operator state</i> (to which category the state handled by this
 interface belongs) always goes through a checkpoint, so it appears
 to the transformation functions like a failure/recovery combination, where recovery happens
 with a different parallelism.

 <p>Conceptually, the state in the checkpoint is the concatenated list of all lists
 returned by the parallel transformation function instances. When restoring from a checkpoint,
 the list is divided into sub-lists that are assigned to each parallel function instance.

 <p>The following sketch illustrates the state redistribution.The function runs with parallelism
 <i>3</i>. The first two parallel instance of the function return lists with two state elements,
 the third one a list with one element.
 <pre>
    func_1        func_2     func_3
 +----+----+   +----+----+   +----+
 | S1 | S2 |   | S3 | S4 |   | S5 |
 +----+----+   +----+----+   +----+
 </pre>

 <p>Recovering the checkpoint with <i>parallelism = 5</i> yields the following state assignment:
 <pre>
 func_1   func_2   func_3   func_4   func_5
 +----+   +----+   +----+   +----+   +----+
 | S1 |   | S2 |   | S3 |   | S4 |   | S5 |
 +----+   +----+   +----+   +----+   +----+
 </pre>

 Recovering the checkpoint with <i>parallelism = 5</i> yields the following state assignment:
 <pre>
      func_1          func_2
 +----+----+----+   +----+----+
 | S1 | S2 | S3 |   | S4 | S5 |
 +----+----+----+   +----+----+
 </pre>

 <h2>Example</h2>
 The following example illustrates how to implement a <code>MapFunction</code> that counts all elements
 passing through it, keeping the total count accurate under re-scaling  (changes or parallelism):
 <pre><code>
 public class CountingFunction&lt;T&gt; implements MapFunction&lt;T, Tuple2&lt;T, Long&gt;&gt;, ListCheckpointed&lt;Long&gt; {

     // this count is the number of elements in the parallel subtask
     private long count;

     {@literal @}Override
     public List&lt;Long&gt; snapshotState(long checkpointId, long timestamp) {
         // return a single element - our count
         return Collections.singletonList(count);
     }

     {@literal @}Override
     public void restoreState(List&lt;Long&gt; state) throws Exception {
         // in case of scale in, this adds up counters from different original subtasks
         // in case of scale out, list this may be empty
         for (Long l : state) {
             count += l;
         }
     }

     {@literal @}Override
     public Tuple2&lt;T, Long&gt; map(T value) {
         count++;
         return new Tuple2&lt;&gt;(value, count);
     }
 }
 </code></pre></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>方法概要</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="方法概要表, 列表方法和解释">
<caption><span id="t0" class="activeTableTab"><span>所有方法</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">实例方法</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">抽象方法</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">限定符和类型</th>
<th class="colLast" scope="col">方法和说明</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/flink/streaming/api/checkpoint/ListCheckpointed.html#restoreState-java.util.List-">restoreState</a></span>(java.util.List&lt;<a href="../../../../../../org/apache/flink/streaming/api/checkpoint/ListCheckpointed.html" title="ListCheckpointed中的类型参数">T</a>&gt;&nbsp;state)</code>
<div class="block">Restores the state of the function or operator to that of a previous checkpoint.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>java.util.List&lt;<a href="../../../../../../org/apache/flink/streaming/api/checkpoint/ListCheckpointed.html" title="ListCheckpointed中的类型参数">T</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/flink/streaming/api/checkpoint/ListCheckpointed.html#snapshotState-long-long-">snapshotState</a></span>(long&nbsp;checkpointId,
             long&nbsp;timestamp)</code>
<div class="block">Gets the current state of the function.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>方法详细资料</h3>
<a name="snapshotState-long-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>snapshotState</h4>
<pre>java.util.List&lt;<a href="../../../../../../org/apache/flink/streaming/api/checkpoint/ListCheckpointed.html" title="ListCheckpointed中的类型参数">T</a>&gt;&nbsp;snapshotState(long&nbsp;checkpointId,
                                long&nbsp;timestamp)
                         throws java.lang.Exception</pre>
<div class="block">Gets the current state of the function. The state must reflect the result of all prior
 invocations to this function.

 <p>The returned list should contain one entry for redistributable unit of state. See
 the <a href="../../../../../../org/apache/flink/streaming/api/checkpoint/ListCheckpointed.html" title="org.apache.flink.streaming.api.checkpoint中的接口"><code>class docs</code></a> for an illustration how list-style state
 redistribution works.

 <p>As special case, the returned list may be null or empty (if the operator has no state)
 or it may contain a single element (if the operator state is indivisible).</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>checkpointId</code> - The ID of the checkpoint - a unique and monotonously increasing value.</dd>
<dd><code>timestamp</code> - The wall clock timestamp when the checkpoint was triggered by the master.</dd>
<dt><span class="returnLabel">返回:</span></dt>
<dd>The operator state in a list of redistributable, atomic sub-states.
         Should not return null, but empty list instead.</dd>
<dt><span class="throwsLabel">抛出:</span></dt>
<dd><code>java.lang.Exception</code> - Thrown if the creation of the state object failed. This causes the
                   checkpoint to fail. The system may decide to fail the operation (and trigger
                   recovery), or to discard this checkpoint attempt and to continue running
                   and to try again with the next checkpoint attempt.</dd>
</dl>
</li>
</ul>
<a name="restoreState-java.util.List-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>restoreState</h4>
<pre>void&nbsp;restoreState(java.util.List&lt;<a href="../../../../../../org/apache/flink/streaming/api/checkpoint/ListCheckpointed.html" title="ListCheckpointed中的类型参数">T</a>&gt;&nbsp;state)
           throws java.lang.Exception</pre>
<div class="block">Restores the state of the function or operator to that of a previous checkpoint.
 This method is invoked when the function is executed after a failure recovery.
 The state list may be empty if no state is to be recovered by the particular parallel instance
 of the function.

 <p>The given state list will contain all the <i>sub states</i> that this parallel
 instance of the function needs to handle. Refer to the  <a href="../../../../../../org/apache/flink/streaming/api/checkpoint/ListCheckpointed.html" title="org.apache.flink.streaming.api.checkpoint中的接口"><code>class docs</code></a>
 for an illustration how list-style state redistribution works.

 <p><b>Important:</b> When implementing this interface together with <a href="../../../../../../org/apache/flink/api/common/functions/RichFunction.html" title="org.apache.flink.api.common.functions中的接口"><code>RichFunction</code></a>,
 then the <code>restoreState()</code> method is called before <a href="../../../../../../org/apache/flink/api/common/functions/RichFunction.html#open-org.apache.flink.configuration.Configuration-"><code>RichFunction.open(Configuration)</code></a>.</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>state</code> - The state to be restored as a list of atomic sub-states.</dd>
<dt><span class="throwsLabel">抛出:</span></dt>
<dd><code>java.lang.Exception</code> - Throwing an exception in this method causes the recovery to fail.
                   The exact consequence depends on the configured failure handling strategy,
                   but typically the system will re-attempt the recovery, or try recovering
                   from a different checkpoint.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="跳过导航链接">跳过导航链接</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="导航">
<li><a href="../../../../../../overview-summary.html">概览</a></li>
<li><a href="package-summary.html">程序包</a></li>
<li class="navBarCell1Rev">类</li>
<li><a href="package-tree.html">树</a></li>
<li><a href="../../../../../../deprecated-list.html">已过时</a></li>
<li><a href="../../../../../../index-files/index-1.html">索引</a></li>
<li><a href="../../../../../../help-doc.html">帮助</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/flink/streaming/api/checkpoint/ExternallyInducedSource.CheckpointTrigger.html" title="org.apache.flink.streaming.api.checkpoint中的接口"><span class="typeNameLink">上一个类</span></a></li>
<li><a href="../../../../../../org/apache/flink/streaming/api/checkpoint/WithMasterCheckpointHook.html" title="org.apache.flink.streaming.api.checkpoint中的接口"><span class="typeNameLink">下一个类</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/flink/streaming/api/checkpoint/ListCheckpointed.html" target="_top">框架</a></li>
<li><a href="ListCheckpointed.html" target="_top">无框架</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">所有类</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>概要:&nbsp;</li>
<li>嵌套&nbsp;|&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method.summary">方法</a></li>
</ul>
<ul class="subNavList">
<li>详细资料:&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method.detail">方法</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
