<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="zh">
<head>
<!-- Generated by javadoc (1.8.0_144) on Thu May 17 13:42:26 CST 2018 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>ZooKeeperStateHandleStore</title>
<meta name="date" content="2018-05-17">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="ZooKeeperStateHandleStore";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":9,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10};
var tabs = {65535:["t0","所有方法"],1:["t1","静态方法"],2:["t2","实例方法"],8:["t4","具体方法"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>您的浏览器已禁用 JavaScript。</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="跳过导航链接">跳过导航链接</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="导航">
<li><a href="../../../../../overview-summary.html">概览</a></li>
<li><a href="package-summary.html">程序包</a></li>
<li class="navBarCell1Rev">类</li>
<li><a href="package-tree.html">树</a></li>
<li><a href="../../../../../deprecated-list.html">已过时</a></li>
<li><a href="../../../../../index-files/index-1.html">索引</a></li>
<li><a href="../../../../../help-doc.html">帮助</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperSharedValue.html" title="org.apache.flink.runtime.zookeeper中的类"><span class="typeNameLink">上一个类</span></a></li>
<li><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.RemoveBackgroundCallback.html" title="org.apache.flink.runtime.zookeeper中的类"><span class="typeNameLink">下一个类</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" target="_top">框架</a></li>
<li><a href="ZooKeeperStateHandleStore.html" target="_top">无框架</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">所有类</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>概要:&nbsp;</li>
<li><a href="#nested.class.summary">嵌套</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">字段</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">构造器</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">方法</a></li>
</ul>
<ul class="subNavList">
<li>详细资料:&nbsp;</li>
<li><a href="#field.detail">字段</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">构造器</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">方法</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.flink.runtime.zookeeper</div>
<h2 title="类 ZooKeeperStateHandleStore" class="title">类 ZooKeeperStateHandleStore&lt;T extends java.io.Serializable&gt;</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.apache.flink.runtime.zookeeper.ZooKeeperStateHandleStore&lt;T&gt;</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt><span class="paramLabel">类型参数:</span></dt>
<dd><code>T</code> - Type of state</dd>
</dl>
<hr>
<br>
<pre>public class <span class="typeNameLabel">ZooKeeperStateHandleStore&lt;T extends java.io.Serializable&gt;</span>
extends java.lang.Object</pre>
<div class="block">Class which stores state via the provided <a href="../../../../../org/apache/flink/runtime/zookeeper/RetrievableStateStorageHelper.html" title="org.apache.flink.runtime.zookeeper中的接口"><code>RetrievableStateStorageHelper</code></a> and writes the
 returned state handle to ZooKeeper. The ZooKeeper node can be locked by creating an ephemeral
 child and only allowing the deletion of the ZooKeeper node if it does not have any children.
 That way we protect concurrent accesses from different ZooKeeperStateHandleStore instances.

 <p>Added state is persisted via <a href="../../../../../org/apache/flink/runtime/state/RetrievableStateHandle.html" title="org.apache.flink.runtime.state中的接口"><code>RetrievableStateHandles</code></a>,
 which in turn are written to ZooKeeper. This level of indirection is necessary to keep the
 amount of data in ZooKeeper small. ZooKeeper is build for data in the KB range whereas
 state can grow to multiple MBs.

 <p>State modifications require some care, because it is possible that certain failures bring
 the state handle backend and ZooKeeper out of sync.

 <p>ZooKeeper holds the ground truth about state handles, i.e. the following holds:

 <pre>
 State handle in ZooKeeper =&gt; State handle exists
 </pre>

 But not:

 <pre>
 State handle exists =&gt; State handle in ZooKeeper
 </pre>

 There can be lingering state handles when failures happen during operation. They
 need to be cleaned up manually (see <a href="https://issues.apache.org/jira/browse/FLINK-2513">
 FLINK-2513</a> about a possible way to overcome this).</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>嵌套类概要</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="嵌套类概要表, 列表嵌套类和解释">
<caption><span>嵌套类</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">限定符和类型</th>
<th class="colLast" scope="col">类和说明</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.RemoveBackgroundCallback.html" title="org.apache.flink.runtime.zookeeper中的类">ZooKeeperStateHandleStore.RemoveBackgroundCallback</a>&lt;<a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.RemoveBackgroundCallback.html" title="ZooKeeperStateHandleStore.RemoveBackgroundCallback中的类型参数">T</a> extends java.io.Serializable&gt;</span></code>
<div class="block">Callback which is executed when removing a node from ZooKeeper.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.RemoveCallback.html" title="org.apache.flink.runtime.zookeeper中的接口">ZooKeeperStateHandleStore.RemoveCallback</a>&lt;<a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.RemoveCallback.html" title="ZooKeeperStateHandleStore.RemoveCallback中的类型参数">T</a> extends java.io.Serializable&gt;</span></code>
<div class="block">Callback interface for remove calls</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>字段概要</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="字段概要表, 列表字段和解释">
<caption><span>字段</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">限定符和类型</th>
<th class="colLast" scope="col">字段和说明</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private org.apache.curator.framework.CuratorFramework</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#client">client</a></span></code>
<div class="block">Curator ZooKeeper client</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.util.concurrent.Executor</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#executor">executor</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#lockNode">lockNode</a></span></code>
<div class="block">Lock node name of this ZooKeeperStateHandleStore.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static org.slf4j.Logger</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#LOG">LOG</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../org/apache/flink/runtime/zookeeper/RetrievableStateStorageHelper.html" title="org.apache.flink.runtime.zookeeper中的接口">RetrievableStateStorageHelper</a>&lt;<a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="ZooKeeperStateHandleStore中的类型参数">T</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#storage">storage</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>构造器概要</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="构造器概要表, 列表构造器和解释">
<caption><span>构造器</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">构造器和说明</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#ZooKeeperStateHandleStore-org.apache.curator.framework.CuratorFramework-org.apache.flink.runtime.zookeeper.RetrievableStateStorageHelper-java.util.concurrent.Executor-">ZooKeeperStateHandleStore</a></span>(org.apache.curator.framework.CuratorFramework&nbsp;client,
                         <a href="../../../../../org/apache/flink/runtime/zookeeper/RetrievableStateStorageHelper.html" title="org.apache.flink.runtime.zookeeper中的接口">RetrievableStateStorageHelper</a>&lt;<a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="ZooKeeperStateHandleStore中的类型参数">T</a>&gt;&nbsp;storage,
                         java.util.concurrent.Executor&nbsp;executor)</code>
<div class="block">Creates a <a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="org.apache.flink.runtime.zookeeper中的类"><code>ZooKeeperStateHandleStore</code></a>.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>方法概要</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="方法概要表, 列表方法和解释">
<caption><span id="t0" class="activeTableTab"><span>所有方法</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">静态方法</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">实例方法</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">具体方法</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">限定符和类型</th>
<th class="colLast" scope="col">方法和说明</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="../../../../../org/apache/flink/runtime/state/RetrievableStateHandle.html" title="org.apache.flink.runtime.state中的接口">RetrievableStateHandle</a>&lt;<a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="ZooKeeperStateHandleStore中的类型参数">T</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#addAndLock-java.lang.String-T-">addAndLock</a></span>(java.lang.String&nbsp;pathInZooKeeper,
          <a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="ZooKeeperStateHandleStore中的类型参数">T</a>&nbsp;state)</code>
<div class="block">Creates a state handle, stores it in ZooKeeper and locks it.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#exists-java.lang.String-">exists</a></span>(java.lang.String&nbsp;pathInZooKeeper)</code>
<div class="block">Returns the version of the node if it exists or <code>-1</code> if it doesn't.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>private <a href="../../../../../org/apache/flink/runtime/state/RetrievableStateHandle.html" title="org.apache.flink.runtime.state中的接口">RetrievableStateHandle</a>&lt;<a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="ZooKeeperStateHandleStore中的类型参数">T</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#get-java.lang.String-boolean-">get</a></span>(java.lang.String&nbsp;pathInZooKeeper,
   boolean&nbsp;lock)</code>
<div class="block">Gets a state handle from ZooKeeper and optionally locks it.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>java.util.List&lt;<a href="../../../../../org/apache/flink/api/java/tuple/Tuple2.html" title="org.apache.flink.api.java.tuple中的类">Tuple2</a>&lt;<a href="../../../../../org/apache/flink/runtime/state/RetrievableStateHandle.html" title="org.apache.flink.runtime.state中的接口">RetrievableStateHandle</a>&lt;<a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="ZooKeeperStateHandleStore中的类型参数">T</a>&gt;,java.lang.String&gt;&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#getAllAndLock--">getAllAndLock</a></span>()</code>
<div class="block">Gets all available state handles from ZooKeeper and locks the respective state nodes.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>java.util.Collection&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#getAllPaths--">getAllPaths</a></span>()</code>
<div class="block">Return a list of all valid paths for state handles.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>java.util.List&lt;<a href="../../../../../org/apache/flink/api/java/tuple/Tuple2.html" title="org.apache.flink.api.java.tuple中的类">Tuple2</a>&lt;<a href="../../../../../org/apache/flink/runtime/state/RetrievableStateHandle.html" title="org.apache.flink.runtime.state中的接口">RetrievableStateHandle</a>&lt;<a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="ZooKeeperStateHandleStore中的类型参数">T</a>&gt;,java.lang.String&gt;&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#getAllSortedByNameAndLock--">getAllSortedByNameAndLock</a></span>()</code>
<div class="block">Gets all available state handles from ZooKeeper sorted by name (ascending) and locks the
 respective state nodes.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code><a href="../../../../../org/apache/flink/runtime/state/RetrievableStateHandle.html" title="org.apache.flink.runtime.state中的接口">RetrievableStateHandle</a>&lt;<a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="ZooKeeperStateHandleStore中的类型参数">T</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#getAndLock-java.lang.String-">getAndLock</a></span>(java.lang.String&nbsp;pathInZooKeeper)</code>
<div class="block">Gets the <a href="../../../../../org/apache/flink/runtime/state/RetrievableStateHandle.html" title="org.apache.flink.runtime.state中的接口"><code>RetrievableStateHandle</code></a> stored in the given ZooKeeper node and locks it.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>protected java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#getLockPath-java.lang.String-">getLockPath</a></span>(java.lang.String&nbsp;rootPath)</code>
<div class="block">Returns the path for the lock node relative to the given path.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>private static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#normalizePath-java.lang.String-">normalizePath</a></span>(java.lang.String&nbsp;path)</code>
<div class="block">Makes sure that every path starts with a "/"</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#release-java.lang.String-">release</a></span>(java.lang.String&nbsp;pathInZooKeeper)</code>
<div class="block">Releases the lock from the node under the given ZooKeeper path.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#releaseAll--">releaseAll</a></span>()</code>
<div class="block">Releases all lock nodes of this ZooKeeperStateHandleStore.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#releaseAndTryRemove-java.lang.String-">releaseAndTryRemove</a></span>(java.lang.String&nbsp;pathInZooKeeper)</code>
<div class="block">Releases the lock for the given state node and tries to remove the state node if it is no longer locked.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#releaseAndTryRemove-java.lang.String-org.apache.flink.runtime.zookeeper.ZooKeeperStateHandleStore.RemoveCallback-">releaseAndTryRemove</a></span>(java.lang.String&nbsp;pathInZooKeeper,
                   <a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.RemoveCallback.html" title="org.apache.flink.runtime.zookeeper中的接口">ZooKeeperStateHandleStore.RemoveCallback</a>&lt;<a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="ZooKeeperStateHandleStore中的类型参数">T</a>&gt;&nbsp;callback)</code>
<div class="block">Releases the lock for the given state node and tries to remove the state node if it is no longer locked.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#releaseAndTryRemoveAll--">releaseAndTryRemoveAll</a></span>()</code>
<div class="block">Releases all lock nodes of this ZooKeeperStateHandleStores and tries to remove all state nodes which
 are not locked anymore.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html#replace-java.lang.String-int-T-">replace</a></span>(java.lang.String&nbsp;pathInZooKeeper,
       int&nbsp;expectedVersion,
       <a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="ZooKeeperStateHandleStore中的类型参数">T</a>&nbsp;state)</code>
<div class="block">Replaces a state handle in ZooKeeper and discards the old state handle.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>从类继承的方法&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>字段详细资料</h3>
<a name="LOG">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>LOG</h4>
<pre>public static&nbsp;org.slf4j.Logger LOG</pre>
</li>
</ul>
<a name="client">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>client</h4>
<pre>private final&nbsp;org.apache.curator.framework.CuratorFramework client</pre>
<div class="block">Curator ZooKeeper client</div>
</li>
</ul>
<a name="storage">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>storage</h4>
<pre>private final&nbsp;<a href="../../../../../org/apache/flink/runtime/zookeeper/RetrievableStateStorageHelper.html" title="org.apache.flink.runtime.zookeeper中的接口">RetrievableStateStorageHelper</a>&lt;<a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="ZooKeeperStateHandleStore中的类型参数">T</a> extends java.io.Serializable&gt; storage</pre>
</li>
</ul>
<a name="executor">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>executor</h4>
<pre>private final&nbsp;java.util.concurrent.Executor executor</pre>
</li>
</ul>
<a name="lockNode">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>lockNode</h4>
<pre>private final&nbsp;java.lang.String lockNode</pre>
<div class="block">Lock node name of this ZooKeeperStateHandleStore. The name should be unique among all other state handle stores.</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>构造器详细资料</h3>
<a name="ZooKeeperStateHandleStore-org.apache.curator.framework.CuratorFramework-org.apache.flink.runtime.zookeeper.RetrievableStateStorageHelper-java.util.concurrent.Executor-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ZooKeeperStateHandleStore</h4>
<pre>public&nbsp;ZooKeeperStateHandleStore(org.apache.curator.framework.CuratorFramework&nbsp;client,
                                 <a href="../../../../../org/apache/flink/runtime/zookeeper/RetrievableStateStorageHelper.html" title="org.apache.flink.runtime.zookeeper中的接口">RetrievableStateStorageHelper</a>&lt;<a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="ZooKeeperStateHandleStore中的类型参数">T</a>&gt;&nbsp;storage,
                                 java.util.concurrent.Executor&nbsp;executor)</pre>
<div class="block">Creates a <a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="org.apache.flink.runtime.zookeeper中的类"><code>ZooKeeperStateHandleStore</code></a>.</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>client</code> - The Curator ZooKeeper client. <strong>Important:</strong> It is
                            expected that the client's namespace ensures that the root
                            path is exclusive for all state handles managed by this
                            instance, e.g. <code>client.usingNamespace("/stateHandles")</code></dd>
<dd><code>storage</code> - to persist the actual state and whose returned state handle is then written
                to ZooKeeper</dd>
<dd><code>executor</code> - to run the ZooKeeper callbacks</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>方法详细资料</h3>
<a name="addAndLock-java.lang.String-java.io.Serializable-">
<!--   -->
</a><a name="addAndLock-java.lang.String-T-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addAndLock</h4>
<pre>public&nbsp;<a href="../../../../../org/apache/flink/runtime/state/RetrievableStateHandle.html" title="org.apache.flink.runtime.state中的接口">RetrievableStateHandle</a>&lt;<a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="ZooKeeperStateHandleStore中的类型参数">T</a>&gt;&nbsp;addAndLock(java.lang.String&nbsp;pathInZooKeeper,
                                            <a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="ZooKeeperStateHandleStore中的类型参数">T</a>&nbsp;state)
                                     throws java.lang.Exception</pre>
<div class="block">Creates a state handle, stores it in ZooKeeper and locks it. A locked node cannot be removed by
 another <a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="org.apache.flink.runtime.zookeeper中的类"><code>ZooKeeperStateHandleStore</code></a> instance as long as this instance remains connected
 to ZooKeeper.

 <p><strong>Important</strong>: This will <em>not</em> store the actual state in
 ZooKeeper, but create a state handle and store it in ZooKeeper. This level of indirection
 makes sure that data in ZooKeeper is small.

 <p>The operation will fail if there is already an node under the given path</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>pathInZooKeeper</code> - Destination path in ZooKeeper (expected to *not* exist yet)</dd>
<dd><code>state</code> - State to be added</dd>
<dt><span class="returnLabel">返回:</span></dt>
<dd>The Created <a href="../../../../../org/apache/flink/runtime/state/RetrievableStateHandle.html" title="org.apache.flink.runtime.state中的接口"><code>RetrievableStateHandle</code></a>.</dd>
<dt><span class="throwsLabel">抛出:</span></dt>
<dd><code>java.lang.Exception</code> - If a ZooKeeper or state handle operation fails</dd>
</dl>
</li>
</ul>
<a name="replace-java.lang.String-int-java.io.Serializable-">
<!--   -->
</a><a name="replace-java.lang.String-int-T-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>replace</h4>
<pre>public&nbsp;void&nbsp;replace(java.lang.String&nbsp;pathInZooKeeper,
                    int&nbsp;expectedVersion,
                    <a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="ZooKeeperStateHandleStore中的类型参数">T</a>&nbsp;state)
             throws java.lang.Exception</pre>
<div class="block">Replaces a state handle in ZooKeeper and discards the old state handle.</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>pathInZooKeeper</code> - Destination path in ZooKeeper (expected to exist and start with a '/')</dd>
<dd><code>expectedVersion</code> - Expected version of the node to replace</dd>
<dd><code>state</code> - The new state to replace the old one</dd>
<dt><span class="throwsLabel">抛出:</span></dt>
<dd><code>java.lang.Exception</code> - If a ZooKeeper or state handle operation fails</dd>
</dl>
</li>
</ul>
<a name="exists-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>exists</h4>
<pre>public&nbsp;int&nbsp;exists(java.lang.String&nbsp;pathInZooKeeper)
           throws java.lang.Exception</pre>
<div class="block">Returns the version of the node if it exists or <code>-1</code> if it doesn't.</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>pathInZooKeeper</code> - Path in ZooKeeper to check</dd>
<dt><span class="returnLabel">返回:</span></dt>
<dd>Version of the ZNode if the path exists, <code>-1</code> otherwise.</dd>
<dt><span class="throwsLabel">抛出:</span></dt>
<dd><code>java.lang.Exception</code> - If the ZooKeeper operation fails</dd>
</dl>
</li>
</ul>
<a name="getAndLock-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAndLock</h4>
<pre>public&nbsp;<a href="../../../../../org/apache/flink/runtime/state/RetrievableStateHandle.html" title="org.apache.flink.runtime.state中的接口">RetrievableStateHandle</a>&lt;<a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="ZooKeeperStateHandleStore中的类型参数">T</a>&gt;&nbsp;getAndLock(java.lang.String&nbsp;pathInZooKeeper)
                                     throws java.lang.Exception</pre>
<div class="block">Gets the <a href="../../../../../org/apache/flink/runtime/state/RetrievableStateHandle.html" title="org.apache.flink.runtime.state中的接口"><code>RetrievableStateHandle</code></a> stored in the given ZooKeeper node and locks it. A
 locked node cannot be removed by another <a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="org.apache.flink.runtime.zookeeper中的类"><code>ZooKeeperStateHandleStore</code></a> instance as long
 as this instance remains connected to ZooKeeper.</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>pathInZooKeeper</code> - Path to the ZooKeeper node which contains the state handle</dd>
<dt><span class="returnLabel">返回:</span></dt>
<dd>The retrieved state handle from the specified ZooKeeper node</dd>
<dt><span class="throwsLabel">抛出:</span></dt>
<dd><code>java.io.IOException</code> - Thrown if the method failed to deserialize the stored state handle</dd>
<dd><code>java.lang.Exception</code> - Thrown if a ZooKeeper operation failed</dd>
</dl>
</li>
</ul>
<a name="getAllPaths--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAllPaths</h4>
<pre>public&nbsp;java.util.Collection&lt;java.lang.String&gt;&nbsp;getAllPaths()
                                                   throws java.lang.Exception</pre>
<div class="block">Return a list of all valid paths for state handles.</div>
<dl>
<dt><span class="returnLabel">返回:</span></dt>
<dd>List of valid state handle paths in ZooKeeper</dd>
<dt><span class="throwsLabel">抛出:</span></dt>
<dd><code>java.lang.Exception</code> - if a ZooKeeper operation fails</dd>
</dl>
</li>
</ul>
<a name="getAllAndLock--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAllAndLock</h4>
<pre>public&nbsp;java.util.List&lt;<a href="../../../../../org/apache/flink/api/java/tuple/Tuple2.html" title="org.apache.flink.api.java.tuple中的类">Tuple2</a>&lt;<a href="../../../../../org/apache/flink/runtime/state/RetrievableStateHandle.html" title="org.apache.flink.runtime.state中的接口">RetrievableStateHandle</a>&lt;<a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="ZooKeeperStateHandleStore中的类型参数">T</a>&gt;,java.lang.String&gt;&gt;&nbsp;getAllAndLock()
                                                                                 throws java.lang.Exception</pre>
<div class="block">Gets all available state handles from ZooKeeper and locks the respective state nodes.

 <p>If there is a concurrent modification, the operation is retried until it succeeds.</div>
<dl>
<dt><span class="returnLabel">返回:</span></dt>
<dd>All state handles from ZooKeeper.</dd>
<dt><span class="throwsLabel">抛出:</span></dt>
<dd><code>java.lang.Exception</code> - If a ZooKeeper or state handle operation fails</dd>
</dl>
</li>
</ul>
<a name="getAllSortedByNameAndLock--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAllSortedByNameAndLock</h4>
<pre>public&nbsp;java.util.List&lt;<a href="../../../../../org/apache/flink/api/java/tuple/Tuple2.html" title="org.apache.flink.api.java.tuple中的类">Tuple2</a>&lt;<a href="../../../../../org/apache/flink/runtime/state/RetrievableStateHandle.html" title="org.apache.flink.runtime.state中的接口">RetrievableStateHandle</a>&lt;<a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="ZooKeeperStateHandleStore中的类型参数">T</a>&gt;,java.lang.String&gt;&gt;&nbsp;getAllSortedByNameAndLock()
                                                                                             throws java.lang.Exception</pre>
<div class="block">Gets all available state handles from ZooKeeper sorted by name (ascending) and locks the
 respective state nodes. The result tuples contain the retrieved state and the path to the
 node in ZooKeeper.

 <p>If there is a concurrent modification, the operation is retried until it succeeds.</div>
<dl>
<dt><span class="returnLabel">返回:</span></dt>
<dd>All state handles in ZooKeeper.</dd>
<dt><span class="throwsLabel">抛出:</span></dt>
<dd><code>java.lang.Exception</code> - If a ZooKeeper or state handle operation fails</dd>
</dl>
</li>
</ul>
<a name="releaseAndTryRemove-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>releaseAndTryRemove</h4>
<pre>public&nbsp;void&nbsp;releaseAndTryRemove(java.lang.String&nbsp;pathInZooKeeper)
                         throws java.lang.Exception</pre>
<div class="block">Releases the lock for the given state node and tries to remove the state node if it is no longer locked.
 The deletion of the state node is executed asynchronously.

 <p><strong>Important</strong>: This also discards the stored state handle after the given action
 has been executed.</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>pathInZooKeeper</code> - Path of state handle to remove (expected to start with a '/')</dd>
<dt><span class="throwsLabel">抛出:</span></dt>
<dd><code>java.lang.Exception</code> - If the ZooKeeper operation fails</dd>
</dl>
</li>
</ul>
<a name="releaseAndTryRemove-java.lang.String-org.apache.flink.runtime.zookeeper.ZooKeeperStateHandleStore.RemoveCallback-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>releaseAndTryRemove</h4>
<pre>public&nbsp;void&nbsp;releaseAndTryRemove(java.lang.String&nbsp;pathInZooKeeper,
                                @Nullable
                                <a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.RemoveCallback.html" title="org.apache.flink.runtime.zookeeper中的接口">ZooKeeperStateHandleStore.RemoveCallback</a>&lt;<a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="ZooKeeperStateHandleStore中的类型参数">T</a>&gt;&nbsp;callback)
                         throws java.lang.Exception</pre>
<div class="block">Releases the lock for the given state node and tries to remove the state node if it is no longer locked.
 The deletion of the state node is executed asynchronously. After the state node has been deleted, the given
 callback is called with the <a href="../../../../../org/apache/flink/runtime/state/RetrievableStateHandle.html" title="org.apache.flink.runtime.state中的接口"><code>RetrievableStateHandle</code></a> of the deleted state node.

 <p><strong>Important</strong>: This also discards the stored state handle after the given action
 has been executed.</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>pathInZooKeeper</code> - Path of state handle to remove</dd>
<dd><code>callback</code> - The callback to execute after a successful deletion. Null if no action needs to be executed.</dd>
<dt><span class="throwsLabel">抛出:</span></dt>
<dd><code>java.lang.Exception</code> - If the ZooKeeper operation fails</dd>
</dl>
</li>
</ul>
<a name="releaseAndTryRemoveAll--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>releaseAndTryRemoveAll</h4>
<pre>public&nbsp;void&nbsp;releaseAndTryRemoveAll()
                            throws java.lang.Exception</pre>
<div class="block">Releases all lock nodes of this ZooKeeperStateHandleStores and tries to remove all state nodes which
 are not locked anymore.

 <p>The delete operation is executed asynchronously</div>
<dl>
<dt><span class="throwsLabel">抛出:</span></dt>
<dd><code>java.lang.Exception</code> - if the delete operation fails</dd>
</dl>
</li>
</ul>
<a name="release-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>release</h4>
<pre>public&nbsp;void&nbsp;release(java.lang.String&nbsp;pathInZooKeeper)
             throws java.lang.Exception</pre>
<div class="block">Releases the lock from the node under the given ZooKeeper path. If no lock exists, then nothing happens.</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>pathInZooKeeper</code> - Path describing the ZooKeeper node</dd>
<dt><span class="throwsLabel">抛出:</span></dt>
<dd><code>java.lang.Exception</code> - if the delete operation of the lock node fails</dd>
</dl>
</li>
</ul>
<a name="releaseAll--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>releaseAll</h4>
<pre>public&nbsp;void&nbsp;releaseAll()
                throws java.lang.Exception</pre>
<div class="block">Releases all lock nodes of this ZooKeeperStateHandleStore.</div>
<dl>
<dt><span class="throwsLabel">抛出:</span></dt>
<dd><code>java.lang.Exception</code> - if the delete operation of a lock file fails</dd>
</dl>
</li>
</ul>
<a name="getLockPath-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLockPath</h4>
<pre>protected&nbsp;java.lang.String&nbsp;getLockPath(java.lang.String&nbsp;rootPath)</pre>
<div class="block">Returns the path for the lock node relative to the given path.</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>rootPath</code> - Root path under which the lock node shall be created</dd>
<dt><span class="returnLabel">返回:</span></dt>
<dd>Path for the lock node</dd>
</dl>
</li>
</ul>
<a name="get-java.lang.String-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>get</h4>
<pre>private&nbsp;<a href="../../../../../org/apache/flink/runtime/state/RetrievableStateHandle.html" title="org.apache.flink.runtime.state中的接口">RetrievableStateHandle</a>&lt;<a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" title="ZooKeeperStateHandleStore中的类型参数">T</a>&gt;&nbsp;get(java.lang.String&nbsp;pathInZooKeeper,
                                      boolean&nbsp;lock)
                               throws java.lang.Exception</pre>
<div class="block">Gets a state handle from ZooKeeper and optionally locks it.</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>pathInZooKeeper</code> - Path in ZooKeeper to get the state handle from</dd>
<dd><code>lock</code> - True if we should lock the node; otherwise false</dd>
<dt><span class="returnLabel">返回:</span></dt>
<dd>The state handle</dd>
<dt><span class="throwsLabel">抛出:</span></dt>
<dd><code>java.io.IOException</code> - Thrown if the method failed to deserialize the stored state handle</dd>
<dd><code>java.lang.Exception</code> - Thrown if a ZooKeeper operation failed</dd>
</dl>
</li>
</ul>
<a name="normalizePath-java.lang.String-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>normalizePath</h4>
<pre>private static&nbsp;java.lang.String&nbsp;normalizePath(java.lang.String&nbsp;path)</pre>
<div class="block">Makes sure that every path starts with a "/"</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>path</code> - Path to normalize</dd>
<dt><span class="returnLabel">返回:</span></dt>
<dd>Normalized path such that it starts with a "/"</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="跳过导航链接">跳过导航链接</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="导航">
<li><a href="../../../../../overview-summary.html">概览</a></li>
<li><a href="package-summary.html">程序包</a></li>
<li class="navBarCell1Rev">类</li>
<li><a href="package-tree.html">树</a></li>
<li><a href="../../../../../deprecated-list.html">已过时</a></li>
<li><a href="../../../../../index-files/index-1.html">索引</a></li>
<li><a href="../../../../../help-doc.html">帮助</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperSharedValue.html" title="org.apache.flink.runtime.zookeeper中的类"><span class="typeNameLink">上一个类</span></a></li>
<li><a href="../../../../../org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.RemoveBackgroundCallback.html" title="org.apache.flink.runtime.zookeeper中的类"><span class="typeNameLink">下一个类</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/flink/runtime/zookeeper/ZooKeeperStateHandleStore.html" target="_top">框架</a></li>
<li><a href="ZooKeeperStateHandleStore.html" target="_top">无框架</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">所有类</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>概要:&nbsp;</li>
<li><a href="#nested.class.summary">嵌套</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">字段</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">构造器</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">方法</a></li>
</ul>
<ul class="subNavList">
<li>详细资料:&nbsp;</li>
<li><a href="#field.detail">字段</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">构造器</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">方法</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
