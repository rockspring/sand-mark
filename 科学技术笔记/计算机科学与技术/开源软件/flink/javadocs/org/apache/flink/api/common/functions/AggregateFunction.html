<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="zh">
<head>
<!-- Generated by javadoc (1.8.0_144) on Thu May 17 13:42:25 CST 2018 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>AggregateFunction</title>
<meta name="date" content="2018-05-17">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="AggregateFunction";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6,"i1":6,"i2":6,"i3":6};
var tabs = {65535:["t0","所有方法"],2:["t2","实例方法"],4:["t3","抽象方法"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>您的浏览器已禁用 JavaScript。</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="跳过导航链接">跳过导航链接</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="导航">
<li><a href="../../../../../../overview-summary.html">概览</a></li>
<li><a href="package-summary.html">程序包</a></li>
<li class="navBarCell1Rev">类</li>
<li><a href="package-tree.html">树</a></li>
<li><a href="../../../../../../deprecated-list.html">已过时</a></li>
<li><a href="../../../../../../index-files/index-1.html">索引</a></li>
<li><a href="../../../../../../help-doc.html">帮助</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/flink/api/common/functions/AbstractRichFunction.html" title="org.apache.flink.api.common.functions中的类"><span class="typeNameLink">上一个类</span></a></li>
<li><a href="../../../../../../org/apache/flink/api/common/functions/BroadcastVariableInitializer.html" title="org.apache.flink.api.common.functions中的接口"><span class="typeNameLink">下一个类</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/flink/api/common/functions/AggregateFunction.html" target="_top">框架</a></li>
<li><a href="AggregateFunction.html" target="_top">无框架</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">所有类</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>概要:&nbsp;</li>
<li>嵌套&nbsp;|&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method.summary">方法</a></li>
</ul>
<ul class="subNavList">
<li>详细资料:&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method.detail">方法</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.flink.api.common.functions</div>
<h2 title="接口 AggregateFunction" class="title">接口 AggregateFunction&lt;IN,ACC,OUT&gt;</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt><span class="paramLabel">类型参数:</span></dt>
<dd><code>IN</code> - The type of the values that are aggregated (input values)</dd>
<dd><code>ACC</code> - The type of the accumulator (intermediate aggregate state).</dd>
<dd><code>OUT</code> - The type of the aggregated result</dd>
</dl>
<dl>
<dt>所有超级接口:</dt>
<dd><a href="../../../../../../org/apache/flink/api/common/functions/Function.html" title="org.apache.flink.api.common.functions中的接口">Function</a>, java.io.Serializable</dd>
</dl>
<dl>
<dt>所有已知实现类:</dt>
<dd><a href="../../../../../../org/apache/flink/api/common/functions/RichAggregateFunction.html" title="org.apache.flink.api.common.functions中的类">RichAggregateFunction</a></dd>
</dl>
<hr>
<br>
<pre><a href="../../../../../../org/apache/flink/annotation/PublicEvolving.html" title="org.apache.flink.annotation中的注释">@PublicEvolving</a>
public interface <span class="typeNameLabel">AggregateFunction&lt;IN,ACC,OUT&gt;</span>
extends <a href="../../../../../../org/apache/flink/api/common/functions/Function.html" title="org.apache.flink.api.common.functions中的接口">Function</a>, java.io.Serializable</pre>
<div class="block">The <code>AggregateFunction</code> is a flexible aggregation function, characterized by the
 following features:
 
 <ul>
     <li>The aggregates may use different types for input values, intermediate aggregates,
         and result type, to support a wide range of aggregation types.</li>
 
     <li>Support for distributive aggregations: Different intermediate aggregates can be
         merged together, to allow for pre-aggregation/final-aggregation optimizations.</li>
 </ul>

 <p>The <code>AggregateFunction</code>'s intermediate aggregate (in-progress aggregation state)
 is called the <i>accumulator</i>. Values are added to the accumulator, and final aggregates are
 obtained by finalizing the accumulator state. This supports aggregation functions where the
 intermediate state needs to be different than the aggregated values and the final result type,
 such as for example <i>average</i> (which typically keeps a count and sum).
 Merging intermediate aggregates (partial aggregates) means merging the accumulators.  
 
 <p>The AggregationFunction itself is stateless. To allow a single AggregationFunction
 instance to maintain multiple aggregates (such as one aggregate per key), the
 AggregationFunction creates a new accumulator whenever a new aggregation is started.
 
 <p>Aggregation functions must be <code>Serializable</code> because they are sent around
 between distributed processes during distributed execution.
 
 <h1>Example: Average and Weighted Average</h1>
 
 <pre><code>
 // the accumulator, which holds the state of the in-flight aggregate
 public class AverageAccumulator {
     long count;
     long sum;
 }
 
 // implementation of an aggregation function for an 'average'
 public class Average implements AggregateFunction&lt;Integer, AverageAccumulator, Double&gt; {
 
     public AverageAccumulator createAccumulator() {
         return new AverageAccumulator();
     }
 
     public AverageAccumulator merge(AverageAccumulator a, AverageAccumulator b) {
         a.count += b.count;
         a.sum += b.sum;
         return a;
     }
 
     public void add(Integer value, AverageAccumulator acc) {
         acc.sum += value;
         acc.count++;
     }
 
     public Double getResult(AverageAccumulator acc) {
         return acc.sum / (double) acc.count;
     }
 }
 
 // implementation of a weighted average
 // this reuses the same accumulator type as the aggregate function for 'average'
 public class WeightedAverage implements AggregateFunction&lt;Datum, AverageAccumulator, Double&gt; {

     public AverageAccumulator createAccumulator() {
         return new AverageAccumulator();
     }

     public AverageAccumulator merge(AverageAccumulator a, AverageAccumulator b) {
         a.count += b.count;
         a.sum += b.sum;
         return a;
     }

     public void add(Datum value, AverageAccumulator acc) {
         acc.count += value.getWeight();
         acc.sum += value.getValue();
     }

     public Double getResult(AverageAccumulator acc) {
         return acc.sum / (double) acc.count;
     }
 }
 </code></pre></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>方法概要</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="方法概要表, 列表方法和解释">
<caption><span id="t0" class="activeTableTab"><span>所有方法</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">实例方法</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">抽象方法</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">限定符和类型</th>
<th class="colLast" scope="col">方法和说明</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html" title="AggregateFunction中的类型参数">ACC</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html#add-IN-ACC-">add</a></span>(<a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html" title="AggregateFunction中的类型参数">IN</a>&nbsp;value,
   <a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html" title="AggregateFunction中的类型参数">ACC</a>&nbsp;accumulator)</code>
<div class="block">Adds the given input value to the given accumulator, returning the
 new accumulator value.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code><a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html" title="AggregateFunction中的类型参数">ACC</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html#createAccumulator--">createAccumulator</a></span>()</code>
<div class="block">Creates a new accumulator, starting a new aggregate.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html" title="AggregateFunction中的类型参数">OUT</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html#getResult-ACC-">getResult</a></span>(<a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html" title="AggregateFunction中的类型参数">ACC</a>&nbsp;accumulator)</code>
<div class="block">Gets the result of the aggregation from the accumulator.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code><a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html" title="AggregateFunction中的类型参数">ACC</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html#merge-ACC-ACC-">merge</a></span>(<a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html" title="AggregateFunction中的类型参数">ACC</a>&nbsp;a,
     <a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html" title="AggregateFunction中的类型参数">ACC</a>&nbsp;b)</code>
<div class="block">Merges two accumulators, returning an accumulator with the merged state.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>方法详细资料</h3>
<a name="createAccumulator--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createAccumulator</h4>
<pre><a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html" title="AggregateFunction中的类型参数">ACC</a>&nbsp;createAccumulator()</pre>
<div class="block">Creates a new accumulator, starting a new aggregate.
 
 <p>The new accumulator is typically meaningless unless a value is added
 via <a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html#add-IN-ACC-"><code>add(Object, Object)</code></a>.
 
 <p>The accumulator is the state of a running aggregation. When a program has multiple
 aggregates in progress (such as per key and window), the state (per key and window)
 is the size of the accumulator.</div>
<dl>
<dt><span class="returnLabel">返回:</span></dt>
<dd>A new accumulator, corresponding to an empty aggregate.</dd>
</dl>
</li>
</ul>
<a name="add-java.lang.Object-java.lang.Object-">
<!--   -->
</a><a name="add-IN-ACC-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>add</h4>
<pre><a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html" title="AggregateFunction中的类型参数">ACC</a>&nbsp;add(<a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html" title="AggregateFunction中的类型参数">IN</a>&nbsp;value,
        <a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html" title="AggregateFunction中的类型参数">ACC</a>&nbsp;accumulator)</pre>
<div class="block">Adds the given input value to the given accumulator, returning the
 new accumulator value.

 <p>For efficiency, the input accumulator may be modified and returned.</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>value</code> - The value to add</dd>
<dd><code>accumulator</code> - The accumulator to add the value to</dd>
</dl>
</li>
</ul>
<a name="getResult-java.lang.Object-">
<!--   -->
</a><a name="getResult-ACC-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getResult</h4>
<pre><a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html" title="AggregateFunction中的类型参数">OUT</a>&nbsp;getResult(<a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html" title="AggregateFunction中的类型参数">ACC</a>&nbsp;accumulator)</pre>
<div class="block">Gets the result of the aggregation from the accumulator.</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>accumulator</code> - The accumulator of the aggregation</dd>
<dt><span class="returnLabel">返回:</span></dt>
<dd>The final aggregation result.</dd>
</dl>
</li>
</ul>
<a name="merge-java.lang.Object-java.lang.Object-">
<!--   -->
</a><a name="merge-ACC-ACC-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>merge</h4>
<pre><a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html" title="AggregateFunction中的类型参数">ACC</a>&nbsp;merge(<a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html" title="AggregateFunction中的类型参数">ACC</a>&nbsp;a,
          <a href="../../../../../../org/apache/flink/api/common/functions/AggregateFunction.html" title="AggregateFunction中的类型参数">ACC</a>&nbsp;b)</pre>
<div class="block">Merges two accumulators, returning an accumulator with the merged state.
 
 <p>This function may reuse any of the given accumulators as the target for the merge
 and return that. The assumption is that the given accumulators will not be used any
 more after having been passed to this function.</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>a</code> - An accumulator to merge</dd>
<dd><code>b</code> - Another accumulator to merge</dd>
<dt><span class="returnLabel">返回:</span></dt>
<dd>The accumulator with the merged state</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="跳过导航链接">跳过导航链接</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="导航">
<li><a href="../../../../../../overview-summary.html">概览</a></li>
<li><a href="package-summary.html">程序包</a></li>
<li class="navBarCell1Rev">类</li>
<li><a href="package-tree.html">树</a></li>
<li><a href="../../../../../../deprecated-list.html">已过时</a></li>
<li><a href="../../../../../../index-files/index-1.html">索引</a></li>
<li><a href="../../../../../../help-doc.html">帮助</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/flink/api/common/functions/AbstractRichFunction.html" title="org.apache.flink.api.common.functions中的类"><span class="typeNameLink">上一个类</span></a></li>
<li><a href="../../../../../../org/apache/flink/api/common/functions/BroadcastVariableInitializer.html" title="org.apache.flink.api.common.functions中的接口"><span class="typeNameLink">下一个类</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/flink/api/common/functions/AggregateFunction.html" target="_top">框架</a></li>
<li><a href="AggregateFunction.html" target="_top">无框架</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">所有类</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>概要:&nbsp;</li>
<li>嵌套&nbsp;|&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method.summary">方法</a></li>
</ul>
<ul class="subNavList">
<li>详细资料:&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method.detail">方法</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
