install.packages(c("gcookbook")
install.packages(c("ggplot2")
library(gcookbook)
library(ggplot2)
ggplot(pg_mean, aes(x=group, y=weight)) + geom_bar(stat = "identity")

ggplot(BOD, aes(x=Time, y=demand)) + geom_bar(stat="identity")

ggplot(BOD, aes(x=factor(Time), y=demand)) + geom_bar(stat="identity")

ggplot(pg_mean, aes(x=group, y=weight)) + geom_bar(stat="identity", fill="lightblue", colour="black")

ggplot(cabbage_exp, aes(x=Date, y=Weight, fill=Cultivar)) + geom_bar(position="dodge", stat="identity")


# 对正负条形图分别着色

library(ggplot2)
library(gcookbook)

csub <- subset(climate, Source=="Berkeley" & Year >= 1900)

## suset

Return subsets of vectors, matrices or data frames which meet conditions.

csub <- subset(climate)

选择符合条件的数据行，第二个参数为条件

csub <- subset(climate, Source=="Berkeley" & Year >= 1900, select=Source:Year)

csub <- subset(climate, Source=="Berkeley" & Year >= 1900, select=Source:Year:Anomaly1y:Anomaly5y:Anomaly10y:Unc10y)

选择指定范围内的列的数据，第三个参数，指定起始列名称和结束列名称，用冒号“:”隔开

csub <- subset(climate, Source=="Berkeley" & Year >= 1900, Source:Year)

可以使用参数名称select

csub <- subset(climate, Source=="Berkeley" & Year >= 1900, select=Source:Year)

选择指定特定几列的数据

csub <- subset(climate, Source=="Berkeley" & Year >= 1900, c(Source,Year,Anomaly10y))


csub <- subset(climate, Source=="Berkeley" & Year >= 1900, select=c(Source,Year,Anomaly10y))


添加一个列

csub$pos <- csub$Anomaly10y >=0



ggplot(csub, aes(x=Year, y=Anomaly10y, fill=pos)) + geom_bar(stat="identity", position="identity")

## 3.10 绘制Cleveland点图

替代条形图，减少视觉混乱

```
library(ggplot2)
library(gcookbook)
tophit <- tophitters2001[1:25, ]
ggplot(tophit, aes(x=avg, y=name)) + geom_point()
```

tophitters2001是2001年美国职业棒球大联盟（Major League Baseball）的144位击球者的击打统计数据。
gcookbook是一个数据包，包含了tophitters2001

绘制普通的点图，不一样的地方时，我们想比较的变量avg作为x轴，比较的类别变量name作为y轴


```
library(ggplot2)
library(gcookbook)

tophit <- tophitters2001[1:25, ]
ggplot(tophit, aes(x=avg, y=reorder(name, avg))) +
  geom_point(size=3) +
  theme_bw() +
  theme(panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.major.y = element_line(colour = "grey60", linetype="dashed")
  )
```

点更大
对y轴的数据重新排序
x轴上的网格线去掉
y轴上的网格线使用虚线，颜色使用灰色grey60


```
library(ggplot2)
library(gcookbook)

tophit <- tophitters2001[1:25, ]
ggplot(tophit, aes(x=reorder(name, avg), y=avg)) +
  geom_point(size=3) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 60, hjust=1),
        panel.grid.major.y = element_blank(),
        panel.grid.minor.y = element_blank(),
        panel.grid.major.x = element_line(colour = "grey60", linetype="dashed")
  )
```

x轴作为要比较的类别变量，y轴作为要比较的值变量
对x轴的类别名称进行重排序，排序准则为与其对应的y轴变量顺序
x轴的文字逆时针旋转60度


```
library(ggplot2)
library(gcookbook)

nameorder <- tophit$name[order(tophit$lg, tophit$avg)]
tophit$name <- factor(tophit$name, levels=nameorder)

ggplot(tophit, aes(x=avg, y=name)) +
  geom_segment(aes(yend=name), xend=0, colour="grey50") +
  geom_point(size=3, aes(colour=lg)) +
  scale_color_brewer(palette = "Set1", limits=c("NL", "AL")) +
  theme_bw() +
  theme(panel.grid.major.y = element_blank(),
        legend.position = c(1, 0.55),
        legend.justification = c(1, 0.5)
  )
```


```
library(ggplot2)
library(gcookbook)

nameorder <- tophit$name[order(tophit$lg, tophit$avg)]
tophit$name <- factor(tophit$name, levels=nameorder)

ggplot(tophit, aes(x=avg, y=name)) +
  geom_segment(aes(yend=name), xend=0, colour="grey50") +
  geom_point(size=3, aes(colour=lg)) +
  scale_color_brewer(palette = "Set1", limits=c("NL", "AL")) +
  theme_bw() +
  theme(panel.grid.major.y = element_blank()) +
  facet_grid(lg ~ ., scales = "free_y", space="free_y")
```